<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CRUD App</title>
</head>
<body>
  <h1>CRUD Application</h1>

  <!-- Create -->
  <form method="POST" action="/add">
    <input type="text" name="name" placeholder="Enter Name" required><br>
  <br>
    <button type="submit">Add</button>
  </form>

  <br>
  <br>

  <!-- Table -->
  <table border="1" cellpadding="5" cellspacing="0">
    <thead>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="data-table"></tbody>
  </table>

  <br>
  <br>

  <!-- Update Form -->
  <form id="updateForm" method="POST" style="display:none; margin-top:10px;">
    <input type="text" id="updateName" name="name" required>
    <button type="submit">Update</button>
  </form>

  <script>
    // Fetch data and display in table
    function loadData() {
      fetch('/getData')
        .then(res => res.json())
        .then(data => {
          const table = document.getElementById('data-table');
          table.innerHTML = '';
          data.forEach(row => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
              <td>${row.id}</td>
              <td>${row.name}</td>
              <td>
                <button onclick="editData(${row.id}, '${row.name}')">Edit</button>
                <a href="/delete/${row.id}">
                  <button type="button">Delete</button>
                </a>
              </td>
            `;
            table.appendChild(tr);
          });
        });
    }

    loadData();

    // Handle edit
    function editData(id, name) {
      const form = document.getElementById('updateForm');
      form.style.display = 'block';
      document.getElementById('updateName').value = name;
      form.action = `/update/${id}`;
    }
  </script>
</body>
</html>
